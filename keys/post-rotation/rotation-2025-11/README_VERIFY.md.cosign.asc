-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512,SHA256

## What this folder contains

* **Provenance statements** (clear-signed with GnuPG post-rotation): `PROVENANCE_v2.0.cosign.asc`
* **Public keys / certs**: `victoria_new.asc`, Yubico roots & intermediates, device/attestation certs
* **Detached signatures** for binaries: `*.pem.asc`
* **Checksums**: `checksums.sha256` + `checksums.sha256.cosign.asc`

## 1) Verify GPG signatures over provenance (clear-signed)

```bash
gpg --verify README_VERIFY.md.cosign.asc
gpg --verify PROVENANCE_v2.0.txt.cosign.asc
gpg --verify WITNESS.md.cosign.asc
```

You should see “Good signature from …” and the expected fingerprint(s).

## 2) Build the Yubico chain (once)

```bash
cat yubico-opgp-ca-1.pem, yubico-intermediate.pem > yubico_chain.pem
```

* `yubico-ca-1.pem` = Yubico root (use in `-CAfile`)
* `yubico_chain.pem` = concatenated intermediates (use in `-untrusted`)

## 3) Verify the device (attestation) certificate

```bash
openssl verify -CAfile yubico-ca-1.pem -untrusted yubico_chain.pem att_certificate_export.pem
# Expect: att_certificate_export.pem: OK
```

## 4) Verify each slot’s **attestation** certificate

Substitute the files that exist in this folder:

```bash
# Signature slot
openssl verify -CAfile yubico-ca-1.pem -untrusted yubico_chain.pem -untrusted att_certificate_export.pem sig_attest.pem

# Encryption slot
openssl verify -CAfile yubico-ca-1.pem -untrusted yubico_chain.pem -untrusted att_certificate_export.pem enc_attest.pem

# Authentication slot
openssl verify -CAfile yubico-ca-1.pem -untrusted yubico_chain.pem -untrusted att_certificate_export.pem aut_attest.pem
```

**Why two `-untrusted`:** OpenSSL needs the intermediate chain *and* the device certificate in the auxiliary store so it can build a complete trust path to the root in `-CAfile`.

## 5) Verify checksums + signature

```bash
sha256sum --check checksums.sha256
gpg --verify checksums.sha256.cosign.asc checksums.sha256
```

## 6) Verify detached signatures over binaries (optional but recommended)

```bash
# Example for a PEM
gpg --verify sig_attest.pem.cosign.asc sig_attest.pem
gpg --verify sig_attest.pem.cosign.asc sig_attest.pem
gpg --verify aut_attest.pem.cosign.asc aut_attest.pem
gpg --verify att_certificate_export.cosign.ct.asc att_certificate_export.pem
```

All verifications should succeed without errors.
-----BEGIN PGP SIGNATURE-----

iHUEARYKAB0WIQTRauO1ee6H3S2O//TeunHGQ8iF0wUCaQeezgAKCRDeunHGQ8iF
0xoUAP9toqoUPyM5lRfT+CC6CwM+a5ocawRyIdnJ+ejZONz8CAD+JAYUQqmBXzzj
7iadTtUx+lslLqJDVmP8ijjwkzJKvwOJAbMEAQEIAB0WIQTNUSYJe51LBSsRtE1+
UF+K48EVbQUCaQeezgAKCRB+UF+K48EVbZ56DACt8ZgBT+ffQcMm6MIgoN6vCEjA
4J9eWokvyPMVpUH/e8g/U2d4nFAPox4SphndHMn3KhxxoLWu+YSVMX3fhDCNHoSF
nRvmwzvAaRj0kDAtNNioeIp+sGkzJqZnFbo1Q78tR+hWM/9xj5cBV9xpAfDJWfX+
WcypCuuIgOrANRzxd1NXujtFgIRU7dkU7iebPC39yji4mgu1mXfxGREzNqVSmGd6
0NYsdf8sE3SWW+7IND/zWVRudKhyZob2tQYOeYDZO17Ua/5XXMweeqvtyjggv16j
AKPPumIH9zerRULAR2oJSEAMQFLO6eG7UiK8Q/tNjnIzSNcF1cq/MEt5daBeCNLZ
wYddNb4oy51BhbpatpMQ0TxuGjwPaP5SJrl0rI0BLFYE3B1toMD2BLjRhBLrn3BG
Ik9WtOhKeftnsytApeFbjnitTlAwsII0+FvFlBzNoL4/g404PBC7eVAaT0cLfx0K
Lf+C5TR8P+sMW82zKT2MD2EQv9eX5vC+1BbU7CY=
=BG45
-----END PGP SIGNATURE-----
